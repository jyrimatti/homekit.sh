#! /usr/bin/env nix-shell
#! nix-shell --keep LOGGING_LEVEL --keep PROFILING -i dash -I channel:nixos-23.05-small -p dash nodejs ncurses
. ./logging
. ./profiling
set -eu

. ./preferences.sh

logger_info 'Invoked api/identify'
logger_trace 'api/identify'

for p in store/pairings/*; do
    if test -d "$p"; then
        dash ./util/respond.sh 400 '{ "status": -70401 }'
        exit 1
    fi
done

dash ./util/respond.sh 204
